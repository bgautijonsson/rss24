{
  "hash": "241066660e5fba03692bd8d4f52036f2",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Gaussian Copulas for Large Spatial Fields\"\nsubtitle: \"Modeling Data-Level Spatial Dependence in Multivariate Generalized Extreme Value Distributions\"\nauthor: \"Brynjólfur Gauti Guðrúnar Jónsson\"\ninstitute: \"University of Iceland\"\nformat: \n  revealjs:\n    theme: theme.scss\n    auto-stretch: true\n    simplemenu:\n      flat: false\n      barhtml:\n        header: \"<div class='menubar mb-10'><ul class='menu'></ul><div>\"\n        footer: \"<div class='footer footer-default' style='display: block;'> <a href='https://bggj.is/rss24' target='_blank'>bggj.is/rss24</a>  <img src='images/hi-audkenni_28-raunsvisd.png' class='slide-logo r-stretch'></div>\"\nhtml-math-method:\n  method: mathjax\n  url: \"https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js\"\nrevealjs-plugins:\n  - simplemenu\n---\n\n::: {.cell}\n\n:::\n\n\n\n\n## Introduction {data-name=\"Background\"}\n::: {.columns style=\"font-size:70%\"}\n\n:::: {.column width=\"70%\"}\n- UKCP Local Projections on a 5km grid over the UK (1980-2080)\n- Challenge: Modeling maximum daily precipitation in yearly blocks\n  - 43,920 spatial locations on a 180 x 244 grid\n- Two aspects of spatial dependence:\n  1. GEV parameters (ICAR models)\n  2. Data-level dependence (Copulas)\n::::\n\n:::: {.column width=\"30%\"}\n![](images/ukcp_data.png){width=\"100%\"}\n::::\n\n:::\n\n## Calculating Multivariate Normal Densities\n\n::: {.columns style=\"font-size:50%\"}\n\n:::: {.column width=\"50%\"}\n### Log Density Formula\n\n$$\n\\log f(\\mathbf{x}) \\propto \\frac{1}{2}\\left(\\log |\\mathbf{Q}| - \\mathbf{x}^T\\mathbf{Q}\\mathbf{x}\\right)\n$$\n\n### Key Components\n\n1. **Log Determinant**: $\\log |\\mathbf{Q}|$\n  - Constant for a given precision matrix\n2. **Quadratic Form**: $\\mathbf{x}^T\\mathbf{Q}\\mathbf{x}$\n  - Needs calculation for each density evaluation\n::::\n\n:::: {.column width=\"50%\"}\n### Computational Challenges\n\n- Log determinant calculation\n  - Time complexity: $O(n^3)$ for naive methods\n  - Memory complexity: $O(n^2)$\n- Quadratic form calculation\n  - Time complexity: $O(n^2)$\n  - Critical for performance in large spatial fields\n\n### Spatial Model Considerations\n\n- Some models (e.g., ICAR) avoid log determinant calculation\n- Efficient computation crucial for large-scale applications\n::::\n\n:::\n\n## Spatial Models\n\n::: {style=\"font-size:40%\"}\n\n#### Conditional Autoregression (CAR)\n:::: {.columns}\n::::: {.column width=\"50%\"}\n* $\\mathbf{D}$ is a diagonal matrix with $D_{ii} = n_i$, the number of neighbours of $i$\n* $\\mathbf{A}$ is the adjacency matrix with $A_{ij} = A_{ji} = 1$ if $i \\sim j$\n* $\\tau$ models overall precision\n:::::\n::::: {.column width=\"50%\"}\n$$\n\\begin{aligned}\n\\mathbf{x} &\\sim N(\\mathbf{0}, \\tau \\mathbf{Q}) \\\\\n\\mathbf{Q} &= \\mathbf{D}\\left(\\mathbf{I} - \\alpha \\mathbf{A} \\right)\n\\end{aligned}\n$$\n:::::\n::::\n\n----------\n\n#### Intrinsic Conditional Autoregression (ICAR)\n:::: {.columns}\n::::: {.column width=\"50%\"}\n* $\\alpha = 1$, so $\\mathbf Q$ is singular, but constant\n* Don't have to calculate $\\log |\\mathbf{Q}|$\n* $\\tau$ is a precision parameter\n:::::\n::::: {.column width=\"50%\"}\n$$\n\\begin{aligned}\n\\mathbf{x} &\\sim N(\\mathbf{0}, \\tau \\mathbf{Q}) \\\\\n\\mathbf{Q} &= \\mathbf{D} - \\mathbf{W}\n\\end{aligned}\n$$\n:::::\n::::\n\n----------\n\n#### BYM (Besag-York-Mollié) Model\n:::: {.columns}\n::::: {.column width=\"50%\"}\n* $\\mathbf{u}$ is the structured spatial component (Besag model)\n* $\\mathbf{v}$ is the unstructured component (i.i.d. normal)\n* $\\tau_u$ and $\\tau_v$ are precision parameters for each component\n:::::\n::::: {.column width=\"50%\"}\n$$\n\\begin{aligned}\n\\mathbf{x} &= \\mathbf{u} + \\mathbf{v} \\\\\n\\mathbf{u} &\\sim \\mathrm{ICAR}(\\tau_u) \\\\\n\\mathbf{v} &\\sim N(\\mathbf{0}, \\tau_v^{-1})\n\\end{aligned}\n$$\n:::::\n::::\n\n----------\n\n#### BYM2  Model\n:::: {.columns}\n::::: {.column width=\"50%\"}\n* Rewrite the combination to get proper scaling\n* $\\rho$ models how much of variance is spatial\n* $s$ is a scaling factor chosen to make $\\mathrm{Var}(\\mathbf u_i) \\approx 1$\n:::::\n::::: {.column width=\"50%\"}\n$$\n\\begin{aligned}\n\\mathbf{x} &= \\left(\\left(\\sqrt{\\rho/s}\\right)\\mathbf{u} + \\left(\\sqrt{1 - \\rho}\\right) \\mathbf{v} \\right)\\sigma \\\\\n\\mathbf{u} &\\sim \\mathrm{ICAR}(1) \\\\\n\\mathbf{v} &\\sim N(\\mathbf{0}, n)\n\\end{aligned}\n$$\n:::::\n::::\n\n:::\n\n## Spatial Modeling on Parameter-level\n\n::: {.columns style=\"font-size:50%\"}\n\n:::: {.column width=\"50%\"}\n\n- $\\mu$: location parameter\n  - $\\mu = \\mu_0 \\left(1 + \\Delta \\left(t - t_0\\right)\\right)$\n  - Model $\\mu_0$ and trend $\\Delta$\n- $\\sigma$: scale parameter\n- $\\xi$: shape parameter\n$$\n\\begin{aligned}\n\\log(\\mu_0) = \\psi &\\sim \\mathrm{BYM2}(\\mu_\\psi, \\rho_\\psi, \\sigma_\\psi) \\\\\n\\log(\\mu_0) - \\log(\\sigma) = \\tau &\\sim \\mathrm{BYM2}(\\mu_\\tau, \\rho_\\tau, \\sigma_\\tau) \\\\\nf_\\xi(\\xi) = \\phi &\\sim \\mathrm{BYM2}(\\mu_\\phi, \\rho_\\phi, \\sigma_\\phi) \\\\\nf_\\Delta(\\Delta) = \\gamma &\\sim \\mathrm{BYM2}(\\mu_\\gamma, \\rho_\\gamma, \\sigma_\\gamma)\n\\end{aligned}\n$$\n![](images/bym_table.png)\n\n::::\n\n:::: {.column width=\"50%\"}\n![](images/facet_constrained.png)\n::::\n\n:::\n\n## From Parameter-level to Data-level Dependence\n\n::: {.columns style=\"font-size:60%\"}\n\n:::: {.column width=\"50%\"}\n### Parameter-level Dependence\n- Assumes conditional independence\n- Biased joint probability estimates\n- Underestimates parameter variance\n::::\n\n:::: {.column width=\"50%\"}\n### Copula\n- Improves joint probabilities\n- Enhances spatial risk assessment\n- Better variance estimates\n::::\n\n:::\n\n::: {style=\"font-size:65%; margin-top:20px;\"}\n**Sklar's Theorem**: For any multivariate distribution $H$, there exists a unique copula $C$ such that:\n\n$$\nH(\\mathbf x) = C(F_1(x_1), \\dots, F_d(x_d))\n$$\n\nwhere $F_i$ are marginal distributions. We can also write this as a density\n\n$$\nh(x) = c(F_1(x_1), \\dots, F_d(x_d)) \\prod_{i=1}^d f_i(x_i)\n$$\n\n:::\n\n## Our Approach: Matérn-like Gaussian Copula\n\n\n::: {style=\"font-size:55%\"}\n\n$$\n\\begin{gathered}\n\\log h(\\mathbf x) = \\log c\\left(F_1(x_1), \\dots, F_d(x_d)\\right) + \\sum_{i=1}^d \\log f_i(x_i)\n\\end{gathered}\n$$\n\n----------\n\n:::: {.columns}\n\n### Marginal CDFs\n::::: {.column width=\"50%\"}\n\n* $F_i(x_i)$ is $\\mathrm{GEV}(\\mu_i, \\sigma_i, \\xi_i)$\n* Can model parameter dependence with BYM2\n\n\n:::::\n\n::::: {.column width=\"50%\"}\n\n$$\n\\begin{aligned}\n\\log h(\\mathbf x) &= \\log c(u_1, \\dots, u_d) \\\\\n&+ \\sum_{i=1}^d \\log f_{\\mathrm{GEV}}(x_i \\vert \\mu_i, \\sigma_i, \\xi_i) \\\\\nu_i &= F_{\\mathrm{GEV}}(x_i \\vert \\mu_i, \\sigma_i, \\xi_i)\n\\end{aligned}\n$$\n\n:::::\n\n::::\n\n----------\n\n\n:::: {.columns}\n\n### Gaussian Copula\n::::: {.column width=\"50%\"}\n\n* Matérn-like precision matrix $\\mathbf{Q}$\n* Scaled so $\\boldsymbol{\\Sigma} = \\mathbf{Q}^{-1}$ is correlation matrix\n* If $\\mathbf{Q} = \\mathbf{I}$ simplifies to independent margins\n* How to generate, scale and compute with $\\mathbf{Q}$ quickly (for MCMC)?\n\n:::::\n\n::::: {.column width=\"50%\"}\n\n$$\n\\begin{aligned}\n\\log c(\\mathbf u) &\\propto \\frac{1}{2}\\left(\\log |\\mathbf{Q}| - \\mathbf{z}^T\\mathbf{Q}\\mathbf{z} + \\mathbf{z}^T\\mathbf{z}\\right) \\\\\n\\mathbf{z} &= \\Phi^{-1}(\\mathbf u)\n\\end{aligned}\n$$\n\n:::::\n\n::::\n\n:::\n\n\n## The Precision Matrix {data-name=\"Methods\"}\n\n::::: {style=\"font-size:60%\"}\n$\\mathbf Q$ defined as Kronecker sum of two AR(1) precision matrices\n\n$$\n\\mathbf{Q} = \\left( \\mathbf{Q}_{\\rho_1} \\otimes \\mathbf{I_{n_2}} + \\mathbf{I_{n_1}} \\otimes \\mathbf{Q}_{\\rho_2} \\right)^{\\nu + 1}, \\quad \\nu \\in \\{0, 1, 2\\}\n$$\n\n:::: {.columns style=\"font-size:80%\"}\n\n::: {.column width=\"50%\"}\n$$\n\\mathbf{Q}_{\\rho_{1}} = \\frac{1}{1-\\rho_{1}^2}\n\\begin{bmatrix}\n1 & -\\rho_{1} & 0 & \\cdots & 0 \\\\\n-\\rho_{1} & 1+\\rho_{1}^2 & -\\rho_{1} & \\cdots & 0 \\\\\n0 & -\\rho_{1} & 1+\\rho_{1}^2 & \\cdots & 0 \\\\\n\\vdots & \\vdots & \\vdots & \\ddots & \\vdots \\\\\n0 & 0 & 0 & \\cdots & 1\n\\end{bmatrix}\n$$\n\n:::\n\n::: {.column width=\"50%\"}\n$$\n\\mathbf{Q}_{\\rho_{2}} = \\frac{1}{1-\\rho_{2}^2}\n\\begin{bmatrix}\n1 & -\\rho_{2} & 0 & \\cdots & 0 \\\\\n-\\rho_{2} & 1+\\rho_{2}^2 & -\\rho_{2} & \\cdots & 0 \\\\\n0 & -\\rho_{2} & 1+\\rho_{2}^2 & \\cdots & 0 \\\\\n\\vdots & \\vdots & \\vdots & \\ddots & \\vdots \\\\\n0 & 0 & 0 & \\cdots & 1\n\\end{bmatrix}\n$$\n\n:::\n\n$$\n\\mathbf Q = \\begin{bmatrix}\n\\frac{1}{(1-\\rho_1^2)}\\mathbf{I_{n_2}} + \\mathbf{Q_{\\rho_2}} & \\frac{-\\rho_1}{(1-\\rho_1^2)}\\mathbf{I_{n_2}} & \\dots & \\cdots & \\dots \\\\\n\\frac{-\\rho_1}{(1-\\rho_1^2)}\\mathbf{I_{n_2}} & \\frac{(1+\\rho_1^2)}{(1-\\rho_1^2)}\\mathbf{I_{n_2}} + \\mathbf{Q_{\\rho_2}} & \\frac{-\\rho_1}{(1-\\rho_1^2)} \\mathbf{I_{n_2}} & \\cdots & \\vdots  \\\\\n\\vdots & \\ddots & \\ddots & \\ddots & \\vdots \\\\\n\\dots & \\dots & \\cdots & \\frac{-\\rho_1}{(1-\\rho_1^2)} \\mathbf{I_{n_2}} & \\frac{1}{(1-\\rho_1^2)}\\mathbf{I_{n_2}} + \\mathbf{Q_{\\rho_2}}\n\\end{bmatrix}^{\\nu + 1}\n$$\n\n::::\n\n\n:::::\n\n\n\n\n\n\n## Eigendecomposition\n\n\n\n:::: {.columns style=\"font-size:65%\"}\n\nBecause of how $\\mathbf{Q}$ is defined, we know that\n\n$$\n\\begin{aligned}\n\\mathbf{Q} &= \\mathbf{V}\\boldsymbol{\\Lambda}\\mathbf{V} \\\\\n&= (\\mathbf{V_{\\rho_1}} \\otimes \\mathbf{V_{\\rho_2}})(\\boldsymbol \\Lambda_{\\rho_1} \\otimes \\mathbf{I} + \\mathbf{I} \\otimes \\boldsymbol \\Lambda_{\\rho_2})^{\\nu + 1}(\\mathbf{V_{\\rho_1}} \\otimes \\mathbf{V_{\\rho_2}})^T\n\\end{aligned}\n$$\n\nwhere\n\n$$\n\\begin{aligned}\n\\mathbf{Q}_{\\rho_1} = \\mathbf{V_{\\rho_1}}\\boldsymbol \\Lambda_{\\rho_1}\\mathbf{V_{\\rho_1}}^T \\qquad \\& \\qquad\n\\mathbf{Q}_{\\rho_2} = \\mathbf{V_{\\rho_2}}\\boldsymbol \\Lambda_{\\rho_2}\\mathbf{V_{\\rho_2}}^T\n\\end{aligned}\n$$\n\n\nSpectral decomposition defined by value/vector pairs of smaller matrices\n\n::: {.column width=\"50%\"}\n\n$$\n\\left\\{\\lambda_{\\rho_1}\\right\\}_i + \\left\\{\\lambda_{\\rho_2}\\right\\}_j\n$$\n\n:::\n::: {.column widht=\"50%\"}\n\n$$\n\\left\\{\\mathbf{v}_{\\rho_1}\\right\\}_i \\otimes \\left\\{\\mathbf{v}_{\\rho_2}\\right\\}_j\n$$\n\n:::\n\n* Problem: $\\boldsymbol \\Sigma_{ii} = \\left(\\mathbf Q^{-1} \\right)_{ii} \\neq  1$\n* Solution: $\\mathbf{\\widetilde  Q} = \\mathbf{D}\\mathbf{Q}\\mathbf{D}$, where $\\mathbf D_{ii} = \\sqrt{\\boldsymbol \\Sigma_{ii}}$\n::::\n\n## Marginal Standard Deviations\n\n::: {style=\"font-size:70%\"}\n\n$$\n\\boldsymbol \\Sigma = \\mathbf Q^{-1} = (\\mathbf{V}\\boldsymbol\\Lambda\\mathbf{V}^T)^{-1} = \\mathbf{V}\\boldsymbol \\Lambda^{-1}\\mathbf{V}\n$$\n\nWe know that if $A = BC$ then $A_{ii} = B_{i, .} C_{., i}$, so\n\n$$\n\\boldsymbol \\Sigma_{ii} = \\sum_{k=1}^{n} v_{ik} \\frac{1}{\\lambda_k} (v^T)_{ki} = \\sum_{k=1}^{n} v_{ik} \\frac{1}{\\lambda_k} v_{ik} = \\sum_{k=1}^{n} v_{ik}^2 \\frac{1}{\\lambda_k}\n$$\n\nCompute vector $\\sigma^2$ containing all marginal variances\n\n$$ \n\\sigma^2 = \\sum_{i = 1}^{n_1} \\sum_{j=1}^{n_2} \\frac{\\left(\\left\\{\\mathbf{v}_{\\rho_1}\\right\\}_i \\otimes \\left\\{\\mathbf{v}_{\\rho_2}\\right\\}_j\\right)^{2}}{\\quad\\left(\\left\\{\\lambda_{\\rho_1}\\right\\}_i + \\left\\{\\lambda_{\\rho_2}\\right\\}_j\\right)^{\\nu+1}}\n$$\n\n:::\n\n## Marginal Standard Deviations\n\n:::: {.columns style=\"font-size:75%\"}\n::: {.column width=\"58%\"}\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndim1 <- 50; dim2 <- 50\nrho1 <- 0.5; rho2 <- 0.3\nnu <- 2\n\nQ1 <- make_AR_prec_matrix(dim1, rho1)\nQ2 <- make_AR_prec_matrix(dim2, rho2)\n\nI1 <- Matrix::Diagonal(dim1)\nI2 <- Matrix::Diagonal(dim2)\n\nQ <- temp <- kronecker(Q1, I2) + kronecker(I1, Q2)\nfor (i in seq_len(nu)) Q <- Q %*% temp\n```\n:::\n\n\n\n:::\n\n::: {.column width=\"42%\"}\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmsd <- function(Q1, Q2) {\n\n  E1 <- eigen(Q1)\n  E2 <- eigen(Q2)\n\n  marginal_sd_eigen(\n    E1$values, E1$vectors, dim1,\n    E2$values, E2$vectors, dim2,\n    nu\n  ) |> \n  sort()\n}\n```\n:::\n\n\n\n:::\n:::: \n\n::: {style=\"font-size:75%\"}\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nbench::mark(\n  \"solve\" = solve(Q) |> diag() |> sqrt() |> sort(),\n  \"inla.qinv\" = inla.qinv(Q) |> diag() |> sqrt() |> sort(),\n  \"marginal_sd_eigen\" = msd(Q1, Q2),\n  iterations = 10,\n  filter_gc = FALSE \n)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 3 × 6\n  expression             min   median `itr/sec` mem_alloc `gc/sec`\n  <bch:expr>        <bch:tm> <bch:tm>     <dbl> <bch:byt>    <dbl>\n1 solve                1.27s     1.3s     0.755   78.17MB    0.755\n2 inla.qinv         378.61ms  395.8ms     2.49     4.35MB    0    \n3 marginal_sd_eigen   1.36ms   1.54ms   574.     649.35KB    0    \n```\n\n\n:::\n:::\n\n\n\n:::\n\n## Calculating the (non-copula) density\n\n::: {style=\"font-size:70%\"}\n\nThe Gaussian log pdf is\n$$\n\\log f(\\mathbf{u} \\vert \\mathbf{Q}) \\propto \\frac{1}{2}\\left(\\log|\\mathbf{Q}| - \\mathbf{z}^T\\mathbf{Q}\\mathbf{z}\\right)\n$$\n\nWithout scaling of $\\mathbf Q$ we get\n\n$$\n\\log|\\mathbf{Q}| = \\sum_{k=1}^{n_1n_2}\\log\\lambda_k = \\sum_{i=1}^{n_1}\\sum_{j=2}^{n_2} \\log\\left[\\left(\\left\\{\\lambda_{\\rho_1}\\right\\}_i + \\left\\{\\lambda_{\\rho_2}\\right\\}_j\\right)^{\\nu + 1}\\right]\n$$\n\n$$\n\\mathbf{z}^T\\mathbf{Q}\\mathbf{z} = \\sum_{k=1}^{n_1n_2}\\lambda_k \\left(v_k^T\\mathbf z\\right)^2 = \n\\sum_{i=1}^{n_1}\\sum_{j=2}^{n_2} \n\\left(\\left\\{\\lambda_{\\rho_1}\\right\\}_i + \\left\\{\\lambda_{\\rho_2}\\right\\}_j\\right)\n\\left[\\left(\\left\\{\\mathbf{v}_{\\rho_1}\\right\\}_i \\otimes \\left\\{\\mathbf{v}_{\\rho_2}\\right\\}_j\\right)^T\\mathbf z\\right]^2\n$$\n\n:::\n\n## Calculating the copula density\n\n::: {style=\"font-size:70%\"}\n\nLet $\\mathbf v = \\left\\{\\mathbf{v}_{\\rho_1}\\right\\}_i \\otimes \\left\\{\\mathbf{v}_{\\rho_2}\\right\\}_j$ and $\\lambda = \\left(\\left\\{\\lambda_{\\rho_1}\\right\\}_i + \\left\\{\\lambda_{\\rho_2}\\right\\}_j\\right)^{\\nu + 1}$. Normalise $\\mathbf v$ and $\\lambda$ with\n\n$$\n\\begin{gathered}\n\\widetilde{\\mathbf{v}} = \\frac{D\\mathbf{v}}{\\vert\\vert D\\mathbf{v}\\vert\\vert_2}, \\qquad\n\\widetilde{\\lambda} = \\vert\\vert D\\mathbf{v}\\vert\\vert_2^2 \\cdot \\lambda\n\\end{gathered}\n$$\n\nThen $\\widetilde{\\mathbf{v}}$ and $\\widetilde{\\lambda}$ are an eigenvector/value pair of the scaled precision matrix $\\mathbf{\\widetilde{Q}}$. Iterate over $i$ and $j$ to calculate\n\n$$\n\\log c(\\mathbf{u} \\vert \\mathbf{\\widetilde{Q}}) = \\frac{1}{2}\\log|\\mathbf{\\widetilde Q}| - \\frac{1}{2}\\mathbf{z}^T\\mathbf{\\widetilde Q}\\mathbf{z} + \\frac{1}{2}\\mathbf{z}^T\\mathbf{z}\n$$\n\n:::\n\n## Folded Circulant Approximation\n\n::: {style=\"font-size:40%\"}\n\n::: {.columns}\n::: {.column width=\"40%\"}\n### AR(1) precision\n\nThe exact form of $Q_{\\rho}$, the precision matrix of a one-dimensional AR(1) process with correlation $\\rho$ is\n\n:::\n::: {.column width=\"60%\"}\n$$\n\\mathbf{Q}_\\rho = \\frac{1}{1-\\rho^2}\n\\begin{bmatrix}\n1 & -\\rho & 0 & \\cdots & 0 \\\\\n-\\rho & 1+\\rho^2 & -\\rho & \\cdots & 0 \\\\\n0 & -\\rho & 1+\\rho^2 & \\cdots & 0 \\\\\n\\vdots & \\vdots & \\vdots & \\ddots & \\vdots \\\\\n0 & 0 & 0 & \\cdots & 1\n\\end{bmatrix}\n$$\n:::\n::: \n\n----------\n\n\n\n\n::: {.columns}\n::: {.column width=\"40%\"}\n### Circulant Approximation\n\nThis approximation treats the first and last observations as neighbors, effectively wrapping the data around a circle.\n\n:::\n::: {.column width=\"60%\"}\n$$\n\\mathbf{Q}_\\rho^{(circ)} = \\frac{1}{1-\\rho^2}\n\\begin{bmatrix}\n1+\\rho^2 & -\\rho & 0 & \\cdots & 0 & -\\rho \\\\\n-\\rho & 1+\\rho^2 & -\\rho & \\cdots & 0 & 0 \\\\\n0 & -\\rho & 1+\\rho^2 & \\cdots & 0 & 0 \\\\\n\\vdots & \\vdots & \\vdots & \\ddots & \\vdots & \\vdots \\\\\n-\\rho & 0 & 0 & \\cdots & -\\rho & 1+\\rho^2\n\\end{bmatrix}\n$$\n:::\n::: \n\n----------\n\n\n::: {.columns}\n::: {.column width=\"40%\"}\n### Folded Circulant Approximation\n\nWe double the data by reflecting it, giving us the data $x_1,  \\dots, x_n, x_n, \\dots, x_1$. We then model this doubled data with a $2n \\times 2n$ circulant matrix. If written out as an $n \\times n$ matrix, it takes the form:\n\n:::\n::: {.column width=\"60%\"}\n$$\n\\mathbf{Q}_\\rho^{(fold)} = \\frac{1}{1-\\rho^2}\n\\begin{bmatrix}\n1-\\rho+\\rho^2 & -\\rho & 0 & \\cdots & 0 & 0 \\\\\n-\\rho & 1+\\rho^2 & -\\rho & \\cdots & 0 & 0 \\\\\n0 & -\\rho & 1+\\rho^2 & \\cdots & 0 & 0 \\\\\n\\vdots & \\vdots & \\vdots & \\ddots & \\vdots & \\vdots \\\\\n0 & 0 & 0 & \\cdots & -\\rho & 1-\\rho+\\rho^2\n\\end{bmatrix}\n$$\n:::\n::: \n\n\n:::\n\n## Benchmark: Density Computations {data-name=\"Results\"}\n\n\n\n\n::: {.cell}\n::: {.cell-output-display}\n\n```{=html}\n<div id=\"uyfvbicrqa\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>#uyfvbicrqa table {\n  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#uyfvbicrqa thead, #uyfvbicrqa tbody, #uyfvbicrqa tfoot, #uyfvbicrqa tr, #uyfvbicrqa td, #uyfvbicrqa th {\n  border-style: none;\n}\n\n#uyfvbicrqa p {\n  margin: 0;\n  padding: 0;\n}\n\n#uyfvbicrqa .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#uyfvbicrqa .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#uyfvbicrqa .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#uyfvbicrqa .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 3px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#uyfvbicrqa .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#uyfvbicrqa .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#uyfvbicrqa .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#uyfvbicrqa .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#uyfvbicrqa .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#uyfvbicrqa .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#uyfvbicrqa .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#uyfvbicrqa .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#uyfvbicrqa .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#uyfvbicrqa .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#uyfvbicrqa .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#uyfvbicrqa .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#uyfvbicrqa .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#uyfvbicrqa .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#uyfvbicrqa .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#uyfvbicrqa .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#uyfvbicrqa .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#uyfvbicrqa .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#uyfvbicrqa .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#uyfvbicrqa .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#uyfvbicrqa .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#uyfvbicrqa .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#uyfvbicrqa .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#uyfvbicrqa .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#uyfvbicrqa .gt_last_grand_summary_row_top {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#uyfvbicrqa .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#uyfvbicrqa .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#uyfvbicrqa .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#uyfvbicrqa .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#uyfvbicrqa .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#uyfvbicrqa .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#uyfvbicrqa .gt_left {\n  text-align: left;\n}\n\n#uyfvbicrqa .gt_center {\n  text-align: center;\n}\n\n#uyfvbicrqa .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#uyfvbicrqa .gt_font_normal {\n  font-weight: normal;\n}\n\n#uyfvbicrqa .gt_font_bold {\n  font-weight: bold;\n}\n\n#uyfvbicrqa .gt_font_italic {\n  font-style: italic;\n}\n\n#uyfvbicrqa .gt_super {\n  font-size: 65%;\n}\n\n#uyfvbicrqa .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#uyfvbicrqa .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#uyfvbicrqa .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#uyfvbicrqa .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#uyfvbicrqa .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#uyfvbicrqa .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#uyfvbicrqa .gt_indent_5 {\n  text-indent: 25px;\n}\n\n#uyfvbicrqa .katex-display {\n  display: inline-flex !important;\n  margin-bottom: 0.75em !important;\n}\n\n#uyfvbicrqa div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {\n  height: 0px !important;\n}\n</style>\n<table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <caption><div data-qmd-base64=\"QmVuY2htYXJraW5nIGhvdyBsb25nIGl0IHRha2VzIHRvIGV2YWx1YXRlIHRoZSBkZW5zaXR5IG9mIGEgTcOhdGVybigkXG51JCktbGlrZSBmaWVsZCB3aXRoIGNvcnJlbGF0aW9uIHBhcmFtZXRlciAkXHJobyQsIGVpdGhlciB1bnNjYWxlZCBvciBzY2FsZWQgdG8gaGF2ZSB1bml0IG1hcmdpbmFsIHZhcmlhbmNl\"><div class='gt_from_md'><p>Benchmarking how long it takes to evaluate the density of a Mátern($\\nu$)-like field with correlation parameter \\(\\rho\\), either unscaled or scaled to have unit marginal variance</p>\n</div></div></caption>\n  <thead>\n    <tr class=\"gt_col_headings gt_spanner_row\">\n      <th class=\"gt_center gt_columns_top_border gt_column_spanner_outer\" rowspan=\"1\" colspan=\"4\" scope=\"colgroup\" id></th>\n      <th class=\"gt_center gt_columns_top_border gt_column_spanner_outer\" rowspan=\"1\" colspan=\"5\" scope=\"colgroup\" id=\"Scaled\">\n        <span class=\"gt_column_spanner\">Scaled</span>\n      </th>\n    </tr>\n    <tr class=\"gt_col_headings gt_spanner_row\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"2\" colspan=\"1\" scope=\"col\" id=\"Q_size\">Q_size</th>\n      <th class=\"gt_center gt_columns_top_border gt_column_spanner_outer\" rowspan=\"1\" colspan=\"3\" scope=\"colgroup\" id=\"Unscaled\">\n        <span class=\"gt_column_spanner\">Unscaled</span>\n      </th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"2\" colspan=\"1\" scope=\"col\" id=\"Eigen\">Eigen</th>\n      <th class=\"gt_center gt_columns_top_border gt_column_spanner_outer\" rowspan=\"1\" colspan=\"2\" scope=\"colgroup\" id=\"Circulant\">\n        <span class=\"gt_column_spanner\">Circulant</span>\n      </th>\n      <th class=\"gt_center gt_columns_top_border gt_column_spanner_outer\" rowspan=\"1\" colspan=\"2\" scope=\"colgroup\" id=\"Folded\">\n        <span class=\"gt_column_spanner\">Folded</span>\n      </th>\n    </tr>\n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Cholesky\">Cholesky</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Eigen\">Eigen</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Speed-up\">Speed-up</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Time\">Time</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Speed-Up\">Speed-Up</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Time\">Time</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Speed-Up\">Speed-Up</th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td headers=\"Q_size\" class=\"gt_row gt_left\">100x100</td>\n<td headers=\"Cholesky (Unscaled)\" class=\"gt_row gt_left\">27.22µs</td>\n<td headers=\"Eigen (Unscaled)\" class=\"gt_row gt_left\">107.36µs</td>\n<td headers=\"sp_3\" class=\"gt_row gt_left\">0.25x</td>\n<td headers=\"Eigen\" class=\"gt_row gt_left\">173.08µs</td>\n<td headers=\"circ\" class=\"gt_row gt_left\">29.03µs</td>\n<td headers=\"sp_1\" class=\"gt_row gt_left\">5.96x</td>\n<td headers=\"fol\" class=\"gt_row gt_left\">36.12µs</td>\n<td headers=\"sp_2\" class=\"gt_row gt_left\">4.79x</td></tr>\n    <tr><td headers=\"Q_size\" class=\"gt_row gt_left\">400x400</td>\n<td headers=\"Cholesky (Unscaled)\" class=\"gt_row gt_left\">157.17µs</td>\n<td headers=\"Eigen (Unscaled)\" class=\"gt_row gt_left\">122.18µs</td>\n<td headers=\"sp_3\" class=\"gt_row gt_left\">1.29x</td>\n<td headers=\"Eigen\" class=\"gt_row gt_left\">241.8µs</td>\n<td headers=\"circ\" class=\"gt_row gt_left\">35.9µs</td>\n<td headers=\"sp_1\" class=\"gt_row gt_left\">6.74x</td>\n<td headers=\"fol\" class=\"gt_row gt_left\">116.09µs</td>\n<td headers=\"sp_2\" class=\"gt_row gt_left\">2.08x</td></tr>\n    <tr><td headers=\"Q_size\" class=\"gt_row gt_left\">900x900</td>\n<td headers=\"Cholesky (Unscaled)\" class=\"gt_row gt_left\">595.1µs</td>\n<td headers=\"Eigen (Unscaled)\" class=\"gt_row gt_left\">223.06µs</td>\n<td headers=\"sp_3\" class=\"gt_row gt_left\">2.67x</td>\n<td headers=\"Eigen\" class=\"gt_row gt_left\">486.01µs</td>\n<td headers=\"circ\" class=\"gt_row gt_left\">88.97µs</td>\n<td headers=\"sp_1\" class=\"gt_row gt_left\">5.46x</td>\n<td headers=\"fol\" class=\"gt_row gt_left\">177.71µs</td>\n<td headers=\"sp_2\" class=\"gt_row gt_left\">2.73x</td></tr>\n    <tr><td headers=\"Q_size\" class=\"gt_row gt_left\">1600x1600</td>\n<td headers=\"Cholesky (Unscaled)\" class=\"gt_row gt_left\">1.47ms</td>\n<td headers=\"Eigen (Unscaled)\" class=\"gt_row gt_left\">461.82µs</td>\n<td headers=\"sp_3\" class=\"gt_row gt_left\">3.18x</td>\n<td headers=\"Eigen\" class=\"gt_row gt_left\">1.18ms</td>\n<td headers=\"circ\" class=\"gt_row gt_left\">109.43µs</td>\n<td headers=\"sp_1\" class=\"gt_row gt_left\">10.82x</td>\n<td headers=\"fol\" class=\"gt_row gt_left\">280.13µs</td>\n<td headers=\"sp_2\" class=\"gt_row gt_left\">4.23x</td></tr>\n    <tr><td headers=\"Q_size\" class=\"gt_row gt_left\">2500x2500</td>\n<td headers=\"Cholesky (Unscaled)\" class=\"gt_row gt_left\">3.09ms</td>\n<td headers=\"Eigen (Unscaled)\" class=\"gt_row gt_left\">948.64µs</td>\n<td headers=\"sp_3\" class=\"gt_row gt_left\">3.26x</td>\n<td headers=\"Eigen\" class=\"gt_row gt_left\">2.49ms</td>\n<td headers=\"circ\" class=\"gt_row gt_left\">143.34µs</td>\n<td headers=\"sp_1\" class=\"gt_row gt_left\">17.39x</td>\n<td headers=\"fol\" class=\"gt_row gt_left\">438.35µs</td>\n<td headers=\"sp_2\" class=\"gt_row gt_left\">5.69x</td></tr>\n    <tr><td headers=\"Q_size\" class=\"gt_row gt_left\">3600x3600</td>\n<td headers=\"Cholesky (Unscaled)\" class=\"gt_row gt_left\">6.12ms</td>\n<td headers=\"Eigen (Unscaled)\" class=\"gt_row gt_left\">1.74ms</td>\n<td headers=\"sp_3\" class=\"gt_row gt_left\">3.52x</td>\n<td headers=\"Eigen\" class=\"gt_row gt_left\">4.89ms</td>\n<td headers=\"circ\" class=\"gt_row gt_left\">182.88µs</td>\n<td headers=\"sp_1\" class=\"gt_row gt_left\">26.76x</td>\n<td headers=\"fol\" class=\"gt_row gt_left\">581.81µs</td>\n<td headers=\"sp_2\" class=\"gt_row gt_left\">8.41x</td></tr>\n    <tr><td headers=\"Q_size\" class=\"gt_row gt_left\">4900x4900</td>\n<td headers=\"Cholesky (Unscaled)\" class=\"gt_row gt_left\">10.98ms</td>\n<td headers=\"Eigen (Unscaled)\" class=\"gt_row gt_left\">2.94ms</td>\n<td headers=\"sp_3\" class=\"gt_row gt_left\">3.73x</td>\n<td headers=\"Eigen\" class=\"gt_row gt_left\">9.29ms</td>\n<td headers=\"circ\" class=\"gt_row gt_left\">246.94µs</td>\n<td headers=\"sp_1\" class=\"gt_row gt_left\">37.6x</td>\n<td headers=\"fol\" class=\"gt_row gt_left\">894.78µs</td>\n<td headers=\"sp_2\" class=\"gt_row gt_left\">10.38x</td></tr>\n    <tr><td headers=\"Q_size\" class=\"gt_row gt_left\">6400x6400</td>\n<td headers=\"Cholesky (Unscaled)\" class=\"gt_row gt_left\">17.11ms</td>\n<td headers=\"Eigen (Unscaled)\" class=\"gt_row gt_left\">4.78ms</td>\n<td headers=\"sp_3\" class=\"gt_row gt_left\">3.58x</td>\n<td headers=\"Eigen\" class=\"gt_row gt_left\">16.07ms</td>\n<td headers=\"circ\" class=\"gt_row gt_left\">295.4µs</td>\n<td headers=\"sp_1\" class=\"gt_row gt_left\">54.41x</td>\n<td headers=\"fol\" class=\"gt_row gt_left\">1.18ms</td>\n<td headers=\"sp_2\" class=\"gt_row gt_left\">13.64x</td></tr>\n    <tr><td headers=\"Q_size\" class=\"gt_row gt_left\">8100x8100</td>\n<td headers=\"Cholesky (Unscaled)\" class=\"gt_row gt_left\">26.15ms</td>\n<td headers=\"Eigen (Unscaled)\" class=\"gt_row gt_left\">7.41ms</td>\n<td headers=\"sp_3\" class=\"gt_row gt_left\">3.53x</td>\n<td headers=\"Eigen\" class=\"gt_row gt_left\">24.5ms</td>\n<td headers=\"circ\" class=\"gt_row gt_left\">456.94µs</td>\n<td headers=\"sp_1\" class=\"gt_row gt_left\">53.61x</td>\n<td headers=\"fol\" class=\"gt_row gt_left\">1.56ms</td>\n<td headers=\"sp_2\" class=\"gt_row gt_left\">15.73x</td></tr>\n    <tr><td headers=\"Q_size\" class=\"gt_row gt_left\">10000x10000</td>\n<td headers=\"Cholesky (Unscaled)\" class=\"gt_row gt_left\">37.42ms</td>\n<td headers=\"Eigen (Unscaled)\" class=\"gt_row gt_left\">11ms</td>\n<td headers=\"sp_3\" class=\"gt_row gt_left\">3.4x</td>\n<td headers=\"Eigen\" class=\"gt_row gt_left\">34.89ms</td>\n<td headers=\"circ\" class=\"gt_row gt_left\">413.3µs</td>\n<td headers=\"sp_1\" class=\"gt_row gt_left\">84.41x</td>\n<td headers=\"fol\" class=\"gt_row gt_left\">1.76ms</td>\n<td headers=\"sp_2\" class=\"gt_row gt_left\">19.86x</td></tr>\n    <tr><td headers=\"Q_size\" class=\"gt_row gt_left\">40000x40000</td>\n<td headers=\"Cholesky (Unscaled)\" class=\"gt_row gt_left\">554.73ms</td>\n<td headers=\"Eigen (Unscaled)\" class=\"gt_row gt_left\">124.41ms</td>\n<td headers=\"sp_3\" class=\"gt_row gt_left\">4.46x</td>\n<td headers=\"Eigen\" class=\"gt_row gt_left\">509.18ms</td>\n<td headers=\"circ\" class=\"gt_row gt_left\">1.59ms</td>\n<td headers=\"sp_1\" class=\"gt_row gt_left\">320.18x</td>\n<td headers=\"fol\" class=\"gt_row gt_left\">10.72ms</td>\n<td headers=\"sp_2\" class=\"gt_row gt_left\">47.49x</td></tr>\n  </tbody>\n  \n  \n</table>\n</div>\n```\n\n:::\n:::\n\n\n\n\n## Benchmark: Maximum Likelihood\n\n\n::: {.columns style=\"font-size:50%\"}\n\n::: {.column width=\"65%\"}\n![](images/bench_ml_bias.png)\n:::\n\n::: {.column width=\"35%\"}\n<br>\n<br>\n\n\n\n\n::: {.cell}\n::: {.cell-output-display}\n\n```{=html}\n<div id=\"nmiqecejaw\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>#nmiqecejaw table {\n  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#nmiqecejaw thead, #nmiqecejaw tbody, #nmiqecejaw tfoot, #nmiqecejaw tr, #nmiqecejaw td, #nmiqecejaw th {\n  border-style: none;\n}\n\n#nmiqecejaw p {\n  margin: 0;\n  padding: 0;\n}\n\n#nmiqecejaw .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#nmiqecejaw .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#nmiqecejaw .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#nmiqecejaw .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 3px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#nmiqecejaw .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#nmiqecejaw .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#nmiqecejaw .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#nmiqecejaw .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#nmiqecejaw .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#nmiqecejaw .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#nmiqecejaw .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#nmiqecejaw .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#nmiqecejaw .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#nmiqecejaw .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#nmiqecejaw .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#nmiqecejaw .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#nmiqecejaw .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#nmiqecejaw .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#nmiqecejaw .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#nmiqecejaw .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#nmiqecejaw .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#nmiqecejaw .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#nmiqecejaw .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#nmiqecejaw .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#nmiqecejaw .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#nmiqecejaw .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#nmiqecejaw .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#nmiqecejaw .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#nmiqecejaw .gt_last_grand_summary_row_top {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#nmiqecejaw .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#nmiqecejaw .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#nmiqecejaw .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#nmiqecejaw .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#nmiqecejaw .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#nmiqecejaw .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#nmiqecejaw .gt_left {\n  text-align: left;\n}\n\n#nmiqecejaw .gt_center {\n  text-align: center;\n}\n\n#nmiqecejaw .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#nmiqecejaw .gt_font_normal {\n  font-weight: normal;\n}\n\n#nmiqecejaw .gt_font_bold {\n  font-weight: bold;\n}\n\n#nmiqecejaw .gt_font_italic {\n  font-style: italic;\n}\n\n#nmiqecejaw .gt_super {\n  font-size: 65%;\n}\n\n#nmiqecejaw .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#nmiqecejaw .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#nmiqecejaw .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#nmiqecejaw .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#nmiqecejaw .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#nmiqecejaw .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#nmiqecejaw .gt_indent_5 {\n  text-indent: 25px;\n}\n\n#nmiqecejaw .katex-display {\n  display: inline-flex !important;\n  margin-bottom: 0.75em !important;\n}\n\n#nmiqecejaw div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {\n  height: 0px !important;\n}\n</style>\n<table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <caption><div data-qmd-base64=\"QmVuY2htYXJraW5nIHNwZWVkIG9mIE1MIGNvbXB1dGF0aW9ucw==\"><div class='gt_from_md'><p>Benchmarking speed of ML computations</p>\n</div></div></caption>\n  <thead>\n    <tr class=\"gt_col_headings gt_spanner_row\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"2\" colspan=\"1\" scope=\"col\" id=\"Grid Size\">Grid Size</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"2\" colspan=\"1\" scope=\"col\" id=\"Exact\">Exact</th>\n      <th class=\"gt_center gt_columns_top_border gt_column_spanner_outer\" rowspan=\"1\" colspan=\"2\" scope=\"colgroup\" id=\"Folded\">\n        <span class=\"gt_column_spanner\">Folded</span>\n      </th>\n    </tr>\n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Time\">Time</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Speed-Up\">Speed-Up</th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td headers=\"dim\" class=\"gt_row gt_left\">10 x 10</td>\n<td headers=\"Exact\" class=\"gt_row gt_left\">6.86ms</td>\n<td headers=\"fold\" class=\"gt_row gt_left\">2.42ms</td>\n<td headers=\"d_1\" class=\"gt_row gt_left\">2.84x</td></tr>\n    <tr><td headers=\"dim\" class=\"gt_row gt_left\">20 x 20</td>\n<td headers=\"Exact\" class=\"gt_row gt_left\">15.42ms</td>\n<td headers=\"fold\" class=\"gt_row gt_left\">7.64ms</td>\n<td headers=\"d_1\" class=\"gt_row gt_left\">2.02x</td></tr>\n    <tr><td headers=\"dim\" class=\"gt_row gt_left\">30 x 30</td>\n<td headers=\"Exact\" class=\"gt_row gt_left\">35.02ms</td>\n<td headers=\"fold\" class=\"gt_row gt_left\">12.13ms</td>\n<td headers=\"d_1\" class=\"gt_row gt_left\">2.89x</td></tr>\n    <tr><td headers=\"dim\" class=\"gt_row gt_left\">40 x 40</td>\n<td headers=\"Exact\" class=\"gt_row gt_left\">75.03ms</td>\n<td headers=\"fold\" class=\"gt_row gt_left\">19.43ms</td>\n<td headers=\"d_1\" class=\"gt_row gt_left\">3.86x</td></tr>\n    <tr><td headers=\"dim\" class=\"gt_row gt_left\">50 x 50</td>\n<td headers=\"Exact\" class=\"gt_row gt_left\">150.24ms</td>\n<td headers=\"fold\" class=\"gt_row gt_left\">28.68ms</td>\n<td headers=\"d_1\" class=\"gt_row gt_left\">5.24x</td></tr>\n    <tr><td headers=\"dim\" class=\"gt_row gt_left\">60 x 60</td>\n<td headers=\"Exact\" class=\"gt_row gt_left\">284.12ms</td>\n<td headers=\"fold\" class=\"gt_row gt_left\">40.26ms</td>\n<td headers=\"d_1\" class=\"gt_row gt_left\">7.06x</td></tr>\n    <tr><td headers=\"dim\" class=\"gt_row gt_left\">70 x 70</td>\n<td headers=\"Exact\" class=\"gt_row gt_left\">485.3ms</td>\n<td headers=\"fold\" class=\"gt_row gt_left\">54.8ms</td>\n<td headers=\"d_1\" class=\"gt_row gt_left\">8.86x</td></tr>\n    <tr><td headers=\"dim\" class=\"gt_row gt_left\">80 x 80</td>\n<td headers=\"Exact\" class=\"gt_row gt_left\">754.37ms</td>\n<td headers=\"fold\" class=\"gt_row gt_left\">74.66ms</td>\n<td headers=\"d_1\" class=\"gt_row gt_left\">10.1x</td></tr>\n  </tbody>\n  \n  \n</table>\n</div>\n```\n\n:::\n:::\n\n\n\n:::\n\n:::\n\n## Approximating the Correlation Matrix \n\n![](images/cors.png)\n\n## Data Generation \n\n:::: {.columns style=\"font-size:60%\"}\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntictoc::tic()\nX <- rmatern_copula_folded_full(n = 100, dim1 = 200, dim2 = 90, rho1 = 0.8, rho2 = 0.9, nu = 2)\ntictoc::toc()\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n0.27 sec elapsed\n```\n\n\n:::\n:::\n\n\n\n\n::: {.column width=\"50%;text-align:center\"}\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nplot_matern(X[, 1], 200, 90)\n```\n\n::: {.cell-output-display}\n![](index_files/figure-revealjs/unnamed-chunk-7-1.png){width=80%}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nplot_matern(X[, 2], 200, 90)\n```\n\n::: {.cell-output-display}\n![](index_files/figure-revealjs/unnamed-chunk-8-1.png){width=80%}\n:::\n:::\n\n\n\n:::\n\n::: {.column width=\"50%\"}\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\napply(X, 1, var) |> hist()\n```\n\n::: {.cell-output-display}\n![](index_files/figure-revealjs/unnamed-chunk-9-1.png){width=80%}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\napply(X, 1, mean) |> hist()\n```\n\n::: {.cell-output-display}\n![](index_files/figure-revealjs/unnamed-chunk-10-1.png){width=80%}\n:::\n:::\n\n\n\n:::\n\n::::\n\n\n## Conclusion and Future Work {data-name=\"Conclusion\"}\n\n::: {.columns style=\"font-size:60%\"}\n\n::: {.column width=\"50%\"}\n\n### Key Results\n\n- Developed Matérn-like Gaussian copula for large spatial fields\n- Folded circulant approximation to the density\n- Achieved fast density computations\n- Viable for MCMC samplers\n\n:::\n::: {.column width=\"50%\"}\n\n### Future Work\n\n- Implement t-copulas\n- Apply to other environmental and climate datasets\n- [Finish drafting paper](https://www.bggj.is/materneigenpaper)\n- [R package](https://www.github.com/bgautijonsson/stdmatern)\n:::\n\n----------\n\n### PhD Committee\n\nMy thanks to my advisor and committee\n\n* Birgir Hrafnkelsson (PI)\n* Raphaël Huser\n* Stefan Siegert\n:::",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-after-body": [
        "\n<script>\n  // htmlwidgets need to know to resize themselves when slides are shown/hidden.\n  // Fire the \"slideenter\" event (handled by htmlwidgets.js) when the current\n  // slide changes (different for each slide format).\n  (function () {\n    // dispatch for htmlwidgets\n    function fireSlideEnter() {\n      const event = window.document.createEvent(\"Event\");\n      event.initEvent(\"slideenter\", true, true);\n      window.document.dispatchEvent(event);\n    }\n\n    function fireSlideChanged(previousSlide, currentSlide) {\n      fireSlideEnter();\n\n      // dispatch for shiny\n      if (window.jQuery) {\n        if (previousSlide) {\n          window.jQuery(previousSlide).trigger(\"hidden\");\n        }\n        if (currentSlide) {\n          window.jQuery(currentSlide).trigger(\"shown\");\n        }\n      }\n    }\n\n    // hookup for slidy\n    if (window.w3c_slidy) {\n      window.w3c_slidy.add_observer(function (slide_num) {\n        // slide_num starts at position 1\n        fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);\n      });\n    }\n\n  })();\n</script>\n\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}